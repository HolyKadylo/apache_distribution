<!DOCTYPE HTML>   
<html>   
  
<head>  
    <title>  
        How to convert JSON data to a 
        html table using JavaScript ? 
    </title> 
      
    <script src= 
"https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"> 
    </script> 
</head>  
  
<body style = "text-align:center;" id = "body">   
      
    <h1 style = "color:orange;" >   
        AutoSME v2   
    </h1> 
      
    <p id = "GFG_UP" style =  
        "font-size: 15px; font-weight: bold;"> 
    </p> 
      
    <button onclick = "constructTable('#table')"> 
        Start 
    </button> 
      
    <br><br> 
      
    <table align = "center"
            id="table" border="1"> 
    </table> 
      
    <script> 
        var el_up = document.getElementById("GFG_UP");
	
	// https://stackoverflow.com/questions/196498/how-do-i-load-the-contents-of-a-text-file-into-a-javascript-variable
	var json = "{}";
	fetch('https://sme.3-3.info/distro.json')
	.then(response => response.text())
	.then((data) => {
		json = data
	})
	var obj = JSON.parse(json);

	// https://www.tutorialrepublic.com/javascript-tutorial/javascript-json-parsing.php
      

        function constructTable(selector) { 
		obj = JSON.parse(json);
		smelist = obj["SMEs"]

            // Getting the all column names 
            var cols = Headers(smelist, selector);   
   
            // Traversing the JSON data 
            for (var i = 0; i < smelist.length; i++) { 
                var row = $('<tr/>');    
                for (var colIndex = 0; colIndex < cols.length; colIndex++) 
                { 
                    var val = smelist[i][cols[colIndex]]; 
                      
                    // If there is any key, which is matching 
                    // with the column name 
                    if (val == null) val = "";   
                        row.append($('<td/>').html(val)); 
                } 
                  
                // Adding each row to the table 
                $(selector).append(row); 
            } 
        } 
          
        function Headers(smelist, selector) { 
		// console.log(smelist);
		// console.log(JSON.stringify(smelist));
		// console.log(smelist.length);

            var columns = []; 
            var header = $('<tr/>'); 
              
            for (var i = 0; i < smelist.length; i++) { 
                var row = JSON.stringify(smelist[i]); 
		// console.log(row);
		row = JSON.parse(row)
		header.append ($('<th/>').html(row["name"]));
            } 
              
            // Appending the header to the table 
            $(selector).append(header); 
                return columns; 
        }        
    </script>  
</body>   
  
</html> 
